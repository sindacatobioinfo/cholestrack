{% extends "base.html" %}
{% load static %}

{% block title %}Saved Configurations - {{ block.super }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-7xl">
    <div class="mb-8">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">
                    <i class="fas fa-folder-open text-purple-600 mr-2"></i>
                    Saved Configurations
                </h1>
                <p class="text-gray-600">
                    View and load your previously saved workflow configurations
                </p>
            </div>
            <a href="{% url 'analysis_workflows:config_builder' %}" class="btn btn-primary">
                <i class="fas fa-plus mr-2"></i>
                New Configuration
            </a>
        </div>
    </div>

    {% if configs %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for config in configs %}
        <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
            <div class="mb-4">
                <h3 class="text-xl font-semibold text-gray-900 mb-1">
                    {{ config.name }}
                </h3>
                <p class="text-sm text-gray-500">
                    Created: {{ config.created_at|date:"Y-m-d H:i" }}
                </p>
            </div>

            <div class="space-y-2 mb-4">
                <div class="flex items-center text-sm">
                    <i class="fas fa-align-left text-green-500 mr-2 w-5"></i>
                    <span class="text-gray-700">
                        {{ config.get_aligner_display }}
                        {% if config.aligner == 'minimap2' and config.minimap2_preset %}
                        ({{ config.get_minimap2_preset_display }})
                        {% endif %}
                    </span>
                </div>

                <div class="flex items-center text-sm">
                    <i class="fas fa-search text-orange-500 mr-2 w-5"></i>
                    <span class="text-gray-700">
                        {% if config.use_gatk %}GATK{% endif %}
                        {% if config.use_gatk and config.use_strelka %}, {% endif %}
                        {% if config.use_strelka %}Strelka{% endif %}
                        {% if not config.use_gatk and not config.use_strelka %}No callers{% endif %}
                    </span>
                </div>

                <div class="flex items-center text-sm">
                    <i class="fas fa-file-medical-alt text-red-500 mr-2 w-5"></i>
                    <span class="text-gray-700">
                        {% if config.run_annovar %}ANNOVAR{% endif %}
                        {% if config.run_annovar and config.run_vep %}, {% endif %}
                        {% if config.run_vep %}VEP{% endif %}
                        {% if not config.run_annovar and not config.run_vep %}No annotation{% endif %}
                    </span>
                </div>
            </div>

            <div class="flex gap-2">
                <a href="{% url 'analysis_workflows:load_config' config.id %}"
                   class="flex-1 btn btn-primary btn-sm text-center">
                    <i class="fas fa-download mr-1"></i>
                    Load
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="bg-gray-50 border border-gray-200 rounded-lg p-8 text-center">
        <i class="fas fa-folder-open text-gray-400 text-5xl mb-4"></i>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">No Saved Configurations</h3>
        <p class="text-gray-600 mb-4">
            You haven't saved any configurations yet.
        </p>
        <a href="{% url 'analysis_workflows:config_builder' %}" class="btn btn-primary">
            <i class="fas fa-plus mr-2"></i>
            Create Your First Configuration
        </a>
    </div>
    {% endif %}
</div>

<style>
    .btn-sm {
        padding: 0.375rem 0.75rem;
        font-size: 0.875rem;
    }
</style>
{% endblock %}
